# –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –∑–∞–ø—É—Å–∫—É —Å–æ–∑–¥–∞–Ω–∏—è —É–∑–ª–∞ Neo4j

## –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞

### 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
```bash
pip install -r requirements.txt
```

### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ Neo4j
–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `neo4j_config.json` —Å –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è:
```json
{
  "NEO4J_URI": "neo4j+s://your-database-url",
  "NEO4J_USERNAME": "neo4j", 
  "NEO4J_PASSWORD": "your-password",
  "NEO4J_DATABASE": "neo4j"
}
```

### 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö
–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –¥–∞–Ω–Ω—ã–µ –æ—Ä–≥–∞–Ω–∏–∑–æ–≤–∞–Ω—ã —Å–ª–µ–¥—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º:
```
–ë–î/
‚îú‚îÄ‚îÄ 2021/
‚îÇ   ‚îú‚îÄ‚îÄ –†–∞–∑–¥–µ–ª 2.1.1.csv          # –§–µ–¥–µ—Ä–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
‚îÇ   ‚îî‚îÄ‚îÄ 2021/                     # –†–µ–≥–∏–æ–Ω–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
‚îÇ       ‚îú‚îÄ‚îÄ –ú–æ—Å–∫–≤–∞/
‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ –†–∞–∑–¥–µ–ª 2.1.1.csv
‚îÇ       ‚îî‚îÄ‚îÄ ...
‚îú‚îÄ‚îÄ 2022/
‚îú‚îÄ‚îÄ 2023/
‚îî‚îÄ‚îÄ 2024/
```

## –ó–∞–ø—É—Å–∫ —Å–æ–∑–¥–∞–Ω–∏—è —É–∑–ª–∞

### –°–ø–æ—Å–æ–± 1: –ü–∞–∫–µ—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
```python
from neo4j_node_creator import Neo4jNodeCreator

# –°–æ–∑–¥–∞–µ–º —ç–∫–∑–µ–º–ø–ª—è—Ä
creator = Neo4jNodeCreator()

# –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –ø–∞–∫–µ—Ç —É–∑–ª–æ–≤ –∏–∑ batch_nodes_config.json
result = creator.process_batch("batch_nodes_config.json")

print(f"–°–æ–∑–¥–∞–Ω–æ —É–∑–ª–æ–≤: {result['created_nodes']}")
print(f"–°–æ–∑–¥–∞–Ω–æ —Å–≤—è–∑–µ–π: {result['total_relationships']}")
print("–õ–æ–≥ –æ–±—Ä–∞–±–æ—Ç–∫–∏:")
for log_entry in result['processing_log']:
    print(f"  {log_entry}")
```

### –°–ø–æ—Å–æ–± 2: –ß–µ—Ä–µ–∑ –∫–æ–º–∞–Ω–¥–Ω—É—é —Å—Ç—Ä–æ–∫—É
```bash
python -c "
from neo4j_node_creator import Neo4jNodeCreator
creator = Neo4jNodeCreator()
result = creator.process_batch('batch_nodes_config.json')
print('–†–µ–∑—É–ª—å—Ç–∞—Ç:', result)
"
```

### –°–ø–æ—Å–æ–± 3: –°–æ–∑–¥–∞–Ω–∏–µ –æ—Ç–¥–µ–ª—å–Ω–æ–≥–æ —Å–∫—Ä–∏–ø—Ç–∞
–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `create_education_node.py`:
```python
#!/usr/bin/env python3
# -*- coding: utf-8 -*-

from neo4j_node_creator import Neo4jNodeCreator

def main():
    print("–°–æ–∑–¥–∞–Ω–∏–µ —É–∑–ª–∞ '–ß–∏—Å–ª–µ–Ω–Ω–æ—Å—Ç—å –æ–±—É—á–∞—é—â–∏—Ö—Å—è –æ–±—â–µ–≥–æ –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è'...")
    
    # –°–æ–∑–¥–∞–µ–º —ç–∫–∑–µ–º–ø–ª—è—Ä
    creator = Neo4jNodeCreator()
    
    try:
        # –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
        result = creator.process_batch("batch_nodes_config.json")
        
        if result['success']:
            print(f"‚úÖ –£—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω–æ —É–∑–ª–æ–≤: {result['created_nodes']}")
            print(f"‚úÖ –°–æ–∑–¥–∞–Ω–æ —Å–≤—è–∑–µ–π: {result['total_relationships']}")
            
            if result['created_node_ids']:
                print("üÜî ID —Å–æ–∑–¥–∞–Ω–Ω—ã—Ö —É–∑–ª–æ–≤:")
                for node_id in result['created_node_ids']:
                    print(f"   {node_id}")
        else:
            print("‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ —É–∑–ª–æ–≤")
            
        print("\nüìã –õ–æ–≥ –æ–±—Ä–∞–±–æ—Ç–∫–∏:")
        for log_entry in result['processing_log']:
            print(f"   {log_entry}")
            
    except Exception as e:
        print(f"‚ùå –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞: {e}")

if __name__ == "__main__":
    main()
```

–ó–∞—Ç–µ–º –∑–∞–ø—É—Å—Ç–∏—Ç–µ:
```bash
python create_education_node.py
```

## –ß—Ç–æ –±—É–¥–µ—Ç —Å–æ–∑–¥–∞–Ω–æ

### –£–∑–µ–ª
```cypher
CREATE (n:StatisticNode {
  name: "–ß–∏—Å–ª–µ–Ω–Ω–æ—Å—Ç—å_–æ–±—É—á–∞—é—â–∏—Ö—Å—è_–æ–±—â–µ–≥–æ_–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è",
  years: [2021, 2022, 2023, 2024],
  federal_values: [–∑–Ω–∞—á–µ–Ω–∏—è –∏–∑ —Ç–∞–±–ª–∏—Ü—ã 2.1.1, –∫–æ–ª–æ–Ω–∫–∞ 3, —Å—Ç—Ä–æ–∫–∞ 10],
  table_number: "2.1.1",
  column: 3,
  row: 10
})
```

### –°–≤—è–∑–∏
1. –û—Ç —É–∑–ª–∞ `4:2a2ab0e9-9777-41b2-89a4-9d85382603dc:158` ‚Üí –Ω–æ–≤—ã–π —É–∑–µ–ª (—Ç–∏–ø: "–ü–æ–£—Ä–æ–≤–µ–Ω—å–û–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è")
2. –û—Ç —É–∑–ª–∞ `4:2a2ab0e9-9777-41b2-89a4-9d85382603dc:47` ‚Üí –Ω–æ–≤—ã–π —É–∑–µ–ª (—Ç–∏–ø: "–ü–æ–û–±—É—á–∞—é—â–∏–π—Å—è")

### –†–µ–≥–∏–æ–Ω–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
–î–ª—è –∫–∞–∂–¥–æ–≥–æ —Ä–µ–≥–∏–æ–Ω–∞ –±—É–¥—É—Ç —Å–æ–∑–¥–∞–Ω—ã —Å–≤—è–∑–∏ —Ç–∏–ø–∞ `:–ü–æ–†–µ–≥–∏–æ–Ω` —Å –¥–∞–Ω–Ω—ã–º–∏ –∑–∞ 2021-2024 –≥–æ–¥—ã.

## –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞

–ü–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è —É–∑–ª–∞ –º–æ–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ Neo4j Browser:

```cypher
// –ù–∞–π—Ç–∏ —Å–æ–∑–¥–∞–Ω–Ω—ã–π —É–∑–µ–ª
MATCH (n:StatisticNode {name: "–ß–∏—Å–ª–µ–Ω–Ω–æ—Å—Ç—å_–æ–±—É—á–∞—é—â–∏—Ö—Å—è_–æ–±—â–µ–≥–æ_–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è"})
RETURN n

// –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–≤—è–∑–∏
MATCH (source)-[r]->(n:StatisticNode {name: "–ß–∏—Å–ª–µ–Ω–Ω–æ—Å—Ç—å_–æ–±—É—á–∞—é—â–∏—Ö—Å—è_–æ–±—â–µ–≥–æ_–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è"})
RETURN source, type(r), n

// –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–µ–≥–∏–æ–Ω–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
MATCH (n:StatisticNode {name: "–ß–∏—Å–ª–µ–Ω–Ω–æ—Å—Ç—å_–æ–±—É—á–∞—é—â–∏—Ö—Å—è_–æ–±—â–µ–≥–æ_–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è"})-[:–ü–æ–†–µ–≥–∏–æ–Ω]->(region:Region)
RETURN n.name, region.name
LIMIT 10
```

## –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### –û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ Neo4j
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤ `neo4j_config.json`
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –¥–æ—Å—Ç—É–ø–Ω–∞

### –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –¥–∞–Ω–Ω—ã—Ö
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞–ª–∏—á–∏–µ —Ñ–∞–π–ª–æ–≤ –≤ –ø–∞–ø–∫–µ `–ë–î/`
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Ç–∞–±–ª–∏—Ü–∞ 2.1.1 —Å–æ–¥–µ—Ä–∂–∏—Ç –¥–∞–Ω–Ω—ã–µ –≤ –∫–æ–ª–æ–Ω–∫–µ 3, —Å—Ç—Ä–æ–∫–µ 10

### –û—à–∏–±–∫–∏ —Å–≤—è–∑–µ–π
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ —É–∑–ª—ã —Å —É–∫–∞–∑–∞–Ω–Ω—ã–º–∏ ID —Å—É—â–µ—Å—Ç–≤—É—é—Ç –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ Neo4j Browser –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ ID —É–∑–ª–æ–≤

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–î–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Ä–∞–±–æ—Ç—ã –º–æ–¥—É–ª—è:
```bash
python test_neo4j_node_creator.py